<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>ZARA - Shopping Cart</title>
    <link rel="stylesheet" href="css/home.css" /> <link rel="stylesheet" href="css/catalogue.css" /> <link rel="stylesheet" href="css/cart.css" />
</head>
<body>
    <div class="cart-page-container">
        <header class="main-header">
            <div class="header-top-row">
                <img class="zara-logo" src="assets/Zara_Logo.svg" alt="Zara Logo" onclick="window.location.href='home.html'">
                <div class="utility-nav">
                    <div class="utility-item">
                        <img class="icon profile-icon" src="assets/profileIcon.svg" alt="Profile">
                        <span class="log-in-text">Log In</span>
                    </div>
                    <div class="utility-item">
                        <img class="icon heart-icon" src="assets/heartIcon.svg" alt="Favorites">
                        <span class="count" id="favCount">0</span>
                    </div>
                    <div class="utility-item">
                        <a href="cart.html"> <img class="icon bag-icon" src="assets/bagIcon.svg" alt="Shopping Bag"> </a>
                        <span class="count" id="bagCount">0</span>
                    </div>
                </div>
            </div>
            <div class="header-bottom-row">
                <nav class="main-nav">
                    <a href="home.html" class="nav-item">NEW ARRIVALS</a>
                    <a href="product.html" class="nav-item">WOMAN</a>
                    <a href="product.html?cat=MAN" class="nav-item">MAN</a>
                    <a href="product.html?cat=KIDS" class="nav-item">KIDS</a>
                </nav>
                <div class="search-section">
                    <input type="text" class="search-input-header" placeholder="" id="headerSearchInput">
                    <img class="icon search-icon-btn" id="searchIcon" src="assets/searchIcon.svg" alt="Search">
                </div>
            </div>
        </header>

        <div class="search-overlay" id="searchOverlay">
            <input type="text" class="search-input-overlay" placeholder="SEARCH FOR PRODUCTS">
            <button class="close-search" id="closeSearch">X</button>
        </div>

        <main class="cart-main-content">
            
            <div class="cart-page-title-container">
                <h1 class="cart-page-title">SHOPPING CART</h1>
            </div>

            <div class="cart-layout">
                <section class="cart-items-section">
                    <div class="cart-item">
                        <img class="cart-item-image" src="assets/clothes1.jpg" alt="Product Image Example 1">
                        <div class="cart-item-details">
                            <div class="cart-item-info">
                                <p class="cart-item-name">Ivory Office Trousers</p>
                                <p class="cart-item-meta">COLOUR: Ivory</p>
                                <p class="cart-item-meta">SIZE: XS</p>
                                <p class="cart-item-unit-price">Rp699.000</p> </div>
                            <div class="cart-item-controls">
                                <div class="cart-item-quantity-section">
                                    <span class="quantity-label">QUANTITY</span>
                                    <div class="quantity-selector">
                                        <button class="qty-btn" id="decreaseQty1">-</button>
                                        <span class="qty-display" id="productQty1">1</span>
                                        <button class="qty-btn" id="increaseQty1">+</button>
                                    </div>
                                </div>
                                <div class="cart-item-subtotal-section">
                                    <span class="subtotal-label">SUBTOTAL</span>
                                    <p class="cart-item-subtotal-value">Rp699.000</p> </div>
                            </div>
                        </div>
                        <button class="remove-item-btn" aria-label="Remove item">&times;</button>
                    </div>
                    <hr class="cart-item-divider">
                    <div class="cart-item">
                        <img class="cart-item-image" src="assets/clothes2.jpg" alt="Product Image Example 2">
                         <div class="cart-item-details">
                            <div class="cart-item-info">
                                <p class="cart-item-name">Floral Maxi Dress</p>
                                <p class="cart-item-meta">COLOUR: Blue</p>
                                <p class="cart-item-meta">SIZE: S</p>
                                <p class="cart-item-unit-price">Rp1.299.000</p> </div>
                            <div class="cart-item-controls">
                                <div class="cart-item-quantity-section">
                                    <span class="quantity-label">QUANTITY</span>
                                    <div class="quantity-selector">
                                        <button class="qty-btn" id="decreaseQty2">-</button>
                                        <span class="qty-display" id="productQty2">1</span>
                                        <button class="qty-btn" id="increaseQty2">+</button>
                                    </div>
                                </div>
                                <div class="cart-item-subtotal-section">
                                    <span class="subtotal-label">SUBTOTAL</span>
                                    <p class="cart-item-subtotal-value">Rp1.299.000</p> </div>
                            </div>
                        </div>
                        <button class="remove-item-btn" aria-label="Remove item">&times;</button>
                    </div>
                    <hr class="cart-item-divider">
                </section>

                <aside class="order-summary-section">
                    <h2 class="summary-title">ORDER SUMMARY | <span id="summaryItemCount">2</span> ITEM(S)</h2>
                    <div class="summary-row">
                        <span>Item(s) subtotal</span>
                        <span>Rp1.998.000</span>
                    </div>
                    <div class="summary-row">
                        <span>VAT included</span>
                        <span>Rp2.040.000</span>
                    </div>
                    <hr class="summary-divider">
                    <div class="summary-row total">
                        <span>ORDER TOTAL</span>
                        <span>Rp2.040.000</span>
                    </div>
                    <button class="checkout-btn" onclick="window.location.href='checkout.html'">CHECKOUT</button>
                    <button class="continue-shopping-btn" onclick="window.location.href='product.html'">CONTINUE SHOPPING</button>
                </aside>
            </div>

            <section class="similar-products-section">
                <h2 class="section-title">SIMILAR PRODUCT</h2>
                <div class="product-grid" id="similarProductsGrid">
                    <!-- Similar products will be rendered here by JS -->
                </div>
            </section>
        </main>

        <footer class="main-footer">
            <div class="footer-content">
                <p>&copy; 2025 ZARA. All rights reserved. | Terms & Conditions | Privacy Policy | Cookies Settings</p>
                <div class="social-links">
                    <a href="#" class="social-icon">Facebook</a>
                    <a href="#" class="social-icon">Instagram</a>
                    <a href="#" class="social-icon">TikTok</a>
                </div>
            </div>
        </footer>
    </div>
    <script src="js/products_data.js"></script>
    <script src="js/cart.js"></script>
    <script>
    // --- Render Similar Products in Cart Page ---
    document.addEventListener('DOMContentLoaded', function() {
        if (!window.ALL_PRODUCTS_DATA) return;
        const grid = document.getElementById('similarProductsGrid');
        if (!grid) return;
        // Get 4 random products (optionally filter by category of first cart item)
        let products = [];
        let cartItems = JSON.parse(localStorage.getItem('cart_items') || '[]');
        if (cartItems.length > 0) {
            // Try to show similar category to first cart item
            const mainCat = cartItems[0].category || cartItems[0].cat || null;
            if (mainCat) {
                products = window.ALL_PRODUCTS_DATA.filter(p => p.category === mainCat);
            } else {
                products = window.ALL_PRODUCTS_DATA.slice();
            }
            // Remove products already in cart
            products = products.filter(p => !cartItems.some(ci => ci.id === p.id));
        } else {
            products = window.ALL_PRODUCTS_DATA.slice();
        }
        // Shuffle and pick 4
        for (let i = products.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [products[i], products[j]] = [products[j], products[i]];
        }
        products = products.slice(0, 4);
        grid.innerHTML = '';
        function getSizeRange(sizes, category) {
            if (!sizes || sizes.length === 0) return '';
            if (category === 'KIDS') {
                // For kids, always show as e.g. 2-11Y
                const first = sizes[0].split('-')[0];
                const last = sizes[sizes.length-1].split('-')[0];
                // If first and last are the same, just show one
                if (first === last) return sizes[0];
                // Always use the full last size (e.g. 10-11Y)
                return `${first}-${sizes[sizes.length-1]}`;
            } else {
                // For WOMAN/MAN, randomly pick a subrange for variety
                if (sizes.length <= 2) return sizes.join('-');
                const ranges = [
                    [0, 2], // XS-M
                    [1, 3], // S-L
                    [0, 3], // XS-L
                    [2, 4], // M-XL
                    [0, sizes.length-1], // XS-3XL or S-XXL
                    [1, sizes.length-2], // S-XXL or S-XL
                ];
                // Pick a random range
                const r = ranges[Math.floor(Math.random()*ranges.length)];
                const start = Math.max(0, r[0]);
                const end = Math.min(sizes.length-1, r[1]);
                if (start >= end) return `${sizes[0]}-${sizes[sizes.length-1]}`;
                return `${sizes[start]}-${sizes[end]}`;
            }
        }
        products.forEach(product => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.setAttribute('data-product-id', product.id);
            card.innerHTML = `
                <a href="product_detail.html?id=${product.id}">
                    <img class="product-thumbnail" src="${product.image}" alt="${product.name}">
                </a>
                <div class="color-swatches-small">
                    ${product.colors.map(c => `<div class='swatch-small' data-color='${c.code}'></div>`).join('')}
                </div>
                <p class="product-meta product-category">${product.category}</p>
                <p class="product-meta product-name">${product.name}</p>
                <p class="product-meta product-price">Rp${product.price.toLocaleString('id-ID')}</p>
                <p class="product-meta product-size-small">${getSizeRange(product.sizes, product.category)}</p>
                <img class="product-card-heart-small" src="assets/heartIcon.svg" alt="Add to Favorites">
            `;
            grid.appendChild(card);
        });
        // Sync favorite state and listeners (reuse logic from cart.js if needed)
        if (window.renderFavoriteStatesForSimilar) renderFavoriteStatesForSimilar();
        if (window.setupFavoriteListenersForSimilar) setupFavoriteListenersForSimilar();
    });
    </script>
</body>
</html>
